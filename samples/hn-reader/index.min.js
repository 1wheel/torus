!function(t){var s={};function o(c){if(s[c])return s[c].exports;var i=s[c]={i:c,l:!1,exports:{}};return t[c].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=s,o.d=function(t,s,c){o.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:c})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,s){if(1&s&&(t=o(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.__esModule)return t;var c=Object.create(null);if(o.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var i in t)o.d(c,i,function(s){return t[s]}.bind(null,i));return c},o.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(s,"a",s),s},o.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},o.p="",o(o.s=0)}([function(t,s,o){const{renderJDOM:c,Component:i,Styled:f,StyledComponent:n,List:h,ListOf:u,Record:g,Store:a,StoreOf:b,Router:w}=o(1),{jdom:d}=o(2);t.exports={renderJDOM:c,Component:i,Styled:f,StyledComponent:n,List:h,ListOf:u,Record:g,Store:a,StoreOf:b,Router:w,jdom:d}},function(t,s,o){const c=["type","value","selected","indeterminate","tabIndex","checked","disabled"];let i=0;const f=t=>"object"==typeof t&&null!==t,n=t=>{"tag"in t||(t.tag="div"),"attrs"in t||(t.attrs={}),"events"in t||(t.events={}),"children"in t||(t.children=[])},h=t=>t instanceof Array?t:[t],u=()=>document.createComment(""),g=new Map;const a=(t,s,o)=>{function b(s){if(void 0!==t&&t!==s&&t.parentNode){const o=u();g.set(o,s),t.parentNode.replaceChild(o,t)}t=s}i++;const w=s!==o;if(w&&o instanceof Node)b(o);else if(w&&null===o)b(u());else if(!w||"string"!=typeof o&&"number"!=typeof o){if("object"==typeof o){f(s)||(s={tag:null}),n(s),n(o),s.tag===o.tag&&t instanceof Node||(void 0===t||n(s={}),b(document.createElement(o.tag)));for(const i in o.attrs)switch(i){case"class":const f=h(s.attrs.class||[]),n=h(o.attrs.class);for(const s of n)t.classList.add(s);for(const s of f)n.includes(s)||t.classList.remove(s);break;case"style":const u=s.attrs.style||{},g=o.attrs.style;for(const s in g)g[s]!==u[s]&&(t.style[s]=g[s]);for(const s in u)s in o.attrs.style||(t.style[s]="");break;default:c.includes(i)?t[i]=o.attrs[i]:o.attrs[i]!==s.attrs[i]&&t.setAttribute(i,o.attrs[i])}for(const i in s.attrs)i in o.attrs||(c.includes(i)?t[i]=null:t.removeAttribute(i));const i=(t,s,o)=>{for(const c in t){const i=h(t[c]||[]),f=h(s[c]);for(const t of i)f.includes(t)||o(c,t)}};i(o.events,s.events,(s,o)=>{t.addEventListener(s,o)}),i(s.events,o.events,(s,o)=>{t.removeEventListener(s,o)});const w=t.childNodes,d=s.children,j=o.children;if(j.length+d.length>0)if(d.length<j.length){let s;for(s=0;s<d.length;s++)a(w[s],d[s],j[s]);for(;s<j.length;)t.appendChild(a(void 0,void 0,j[s])),s++}else{let s;for(s=0;s<j.length;s++)a(w[s],d[s],j[s]);for(;s<d.length;){const o=u();t.replaceChild(o,w[s]),g.set(o,null),s++}}}}else b(document.createTextNode(o));return 0===--i&&function(){for(const[t,s]of g.entries())null===s?t.parentNode.removeChild(t):t.parentNode.replaceChild(s,t);g.clear()}(),t},b=()=>({source:null,handler:()=>{}});class w{constructor(...t){this.jdom=void 0,this.node=void 0,this.event=b(),this.init(...t),this.render()}static from(t){return class extends w{init(...t){this.args=t}compose(){return t(...this.args)}}}init(){}get record(){return this.event.source}bind(t,s){if(this.unbind(),!(t instanceof $))throw new Error("Event source to bind() to is not an instance of Evented");this.event={source:t,handler:s},t.addHandler(s)}unbind(){this.record&&this.record.removeHandler(this.event.handler),this.event=b()}remove(){this.unbind()}compose(t){return null}preprocess(t,s){return t}render(t){t=t||this.record&&this.record.summarize();const s=this.preprocess(this.compose(t),t);return this.node=a(this.node,this.jdom,s),this.jdom=s,this.jdom}}const d=new Set;let j=null;const k=(t,s)=>t+"{"+s+"}",m=(t,s)=>{let o=[],c="";for(const[i,f]of Object.entries(s))if("@"===i[0])i.startsWith("@media")?o.push(k(i,m(t,f).join(""))):o.push(k(i,m("",f).join("")));else if("object"==typeof f)if(i.includes("&")){const s=i.replace(/&/g,t);o=o.concat(m(s,f))}else o=o.concat(m(t+" "+i,f));else c+=i+":"+f+";";return c&&o.push(k(t,c)),o},p=t=>{const s=(t=>{const s=JSON.stringify(t).replace(/\s+/g," ");let o=s.length,c=1989;for(;o;)c=13*c^s.charCodeAt(--o);return"_torus"+(c>>>0)})(t);if(!d.has(s)){j||(styleElement=document.createElement("style"),styleElement.setAttribute("data-torus",""),document.head.appendChild(styleElement),j=styleElement.sheet);const o=m("."+s,t);for(const t of o)j.insertRule(t,j.cssRules.length);d.add(s)}return s},R=t=>(class extends t{styles(t){return{}}preprocess(t,s){return f(t)&&(t.attrs=t.attrs||{},t.attrs.class=h(t.attrs.class||[]),t.attrs.class.push(p(this.styles(s)))),t}}),L=R(w);class W extends w{get itemClass(){return w}init(t){this.store=t,this.items=new Map,this.filterFn=null,this.bind(this.store,()=>this.itemsChanged()),this.itemsChanged()}itemsChanged(){const t=this.store.summarize();for(const s of this.items.keys())t.includes(s)||(this.items.get(s).remove(),this.items.delete(s));for(const s of t)this.items.has(s)||this.items.set(s,new this.itemClass(s));let s=[...this.items.entries()];null!==this.filterFn&&(s=s.filter(t=>this.filterFn(t[0]))),s.sort((s,o)=>t.indexOf(s[0])-t.indexOf(o[0])),this.items=new Map(s),this.render()}filter(t){this.filterFn=t,this.itemsChanged()}unfilter(){this.filterFn=null,this.itemsChanged()}get nodes(){return[...this.items.values()].map(t=>t.node)}remove(){super.remove();for(const t of this.items.values())t.remove()}compose(t){return{tag:"ul",children:this.nodes}}}class ${constructor(){this.eventTargets=new Set}summarize(){throw new Error(`#summarize() not implemented in ${this.constructor.name}`)}emitEvent(){const t=this.summarize();for(const s of this.eventTargets)s(t)}addHandler(t){this.eventTargets.add(t),t(this.summarize())}removeHandler(t){this.eventTargets.delete(t)}}class r extends ${constructor(t,s={}){super(),"object"!=typeof t||Object.keys(s).length||(s=t,t=null),this.id=t,this.data=s}update(t){Object.assign(this.data,t),this.emitEvent()}get(t){return this.data[t]}summarize(){return Object.assign({},this.data,{id:this.id})}serialize(){return this.summarize()}}class U extends ${constructor(t=[]){super(),this.reset(t)}get recordClass(){return r}get comparator(){return null}create(t,s){this.add(new this.recordClass(t,s))}add(t){this.records.add(t),this.emitEvent()}remove(t){this.records.delete(t),this.emitEvent()}reset(t){this.records=new Set(t),this.emitEvent()}summarize(){return[...this.records].map(t=>[this.comparator?this.comparator(t):null,t]).sort((t,s)=>t[0]<s[0]?-1:t[0]>s[0]?1:0).map(t=>t[1])}serialize(){return this.summarize().map(t=>t.serialize())}}const _=t=>{let s;const o=[];for(;null!==s;)if(s=/:\w+/.exec(t)){const c=s[0];o.push(c.substr(1)),t=t.replace(c,"(.*)")}return[new RegExp(t),o]};const A={renderJDOM:a,Component:w,Styled:R,StyledComponent:L,List:W,ListOf:t=>(class extends W{get itemClass(){return t}}),Record:r,Store:U,StoreOf:t=>(class extends U{get recordClass(){return t}}),Router:class extends ${constructor(t){super(),this.routes=Object.entries(t).map(([t,s])=>[t,..._(s)]),this.lastMatch=["",null],this._cb=(()=>this.route(location.pathname)),window.addEventListener("popstate",this._cb),this._cb()}summarize(){return this.lastMatch}go(t){history.pushState(null,document.title,t),this.route(t)}route(t){for(const[s,o,c]of this.routes){const i=o.exec(t);if(null!==i){const t={},o=i.slice(1);c.forEach((s,c)=>t[s]=o[c]),this.lastMatch=[s,t];break}}this.emitEvent()}remove(){window.removeEventListener("popstate",this._cb)}}};if("object"==typeof window)for(const t in A)window[t]=A[t];"object"==typeof t.exports&&(t.exports=A)},function(t,s,o){const c=t=>"object"==typeof t&&null!==t&&"tag"in t,i="undefined"==typeof Node?c:t=>t instanceof Node||c(t),f=(t,s)=>t.substr(0,t.length-s.length),n=t=>String.fromCodePoint(+("0"+/&#(\w+);/.exec(t)[1])),h=(t,s)=>{let o=t[0];for(let c=1;c<=s.length;c++)o+=s[c-1]+t[c];return o},u=[];class g{constructor(t,s){this.idx=0,this.subIdx=0,this.parts=[t[0]];for(let o=1;o<t.length;o++)this.parts.push(s[o-1]),this.parts.push(t[o])}trim(){const t=this.parts.length;this.parts[0]=this.parts[0].replace(/^\s+/g,""),this.parts[t-1]=this.parts[t-1].replace(/\s+$/g,"")}next(){const t=this.parts.length,s=this.parts[this.idx],o=this.idx>=t?t:this.idx+1;if("string"==typeof s){const t=s[this.subIdx]||"";return++this.subIdx>=s.length&&(this.idx=o,this.subIdx=0),t}return this.idx>=t?u:(this.idx=o,s)}backtrack(){0!==this.subIdx?this.subIdx--:(this.idx=this.idx<=1?0:this.idx-1,"string"==typeof this.parts[this.idx]&&(this.subIdx=this.parts[this.idx].length-1))}readUpto(t){const s=this.readUntil(t),o=s[0];o[o.length-1]=f(o[o.length-1],t);let c=t.length;for(;c--;)this.backtrack();return s}readUntil(t){const s=[""],o=[];let c;for(;!s[s.length-1].endsWith(t)&&c!==u&&(c=this.next())!==u;)"string"==typeof c?s[s.length-1]+=c:(o.push(c),s.push(""));return[s,o]}clipEnd(t){const s=this.parts[this.parts.length-1];return!!s.endsWith(t)&&(this.parts[this.parts.length-1]=f(s,t),!0)}}const a=t=>{let s="";for(let o=0;o<t.length;o++)s+="-"===t[o]?t[++o].toUpperCase():t[o];return s},b=(t,s)=>{if("!"===t[0][0])return null;if(1===t.length&&!t[0].includes(" ")){const s=t[0].endsWith("/");return{jdom:{tag:s?f(t[0],"/"):t[0],attrs:{},events:{}},selfClosing:s}}const o=new g(t,s);o.trim();const c=o.clipEnd("/");let i="";const n={},b={},w=(t,s)=>{if("function"==typeof s)b[t.replace("on","")]=[s];else if("class"===t)(s=s.trim())&&(n[t]=s.split(" "));else if("style"===t){const o=s.split(";").filter(t=>!!t).map(t=>{const[s,...o]=t.split(":");return[a(s.trim()),o.join(":").trim()]}),c={};for(const[t,s]of o)c[t]=s;n[t]=c}else n[t]=s};let d=[""],j=[],k=!1,m=!1;const p=[];let R=0;const L=(t,s,o)=>{(""!==s||o)&&(p.push({type:t,value:s}),k=!1)},W=t=>{d.reverse(),2==d.length&&""===d[0]&&""===d[1]?1===j.length&&1===R?L(1,j[0],t):L(R,h(d,j),t):L(R,h(d,j).trim(),t),d=[""],j=[]};for(let t=o.next();t!==u;t=o.next())switch(t){case"=":m?d[0]+=t:(W(),k=!0,R=1);break;case" ":m?d[0]+=t:k||(W(),R=0);break;case"\\":m&&(t=o.next(),d[0]+=t);break;case'"':m?(m=!1,W(!0),R=0):1===R&&(m=!0);break;default:"string"==typeof t?d[0]+=t:(j.unshift(t),d.unshift("")),k=!1}W(),i=p.shift().value;let $=null,r=p.shift();const U=()=>{$=r,r=p.shift()};for(;void 0!==r;)1===r.type?(w($.value,r.value),U()):$&&w($.value,!0),U();return $&&0===$.type&&w($.value,!0),{jdom:{tag:i,attrs:n,events:b},selfClosing:c}},w=t=>{const s=[];let o=null,c=!1;const f=()=>{c&&""===o.trim()&&(o=null),o&&s.push(o),o=null,c=!1},h=t=>{c||(f(),c=!0,o=""),o+=t};for(let s=t.next();s!==u;s=t.next())if("<"===s){if(f(),"/"===t.next()){t.readUntil(">");break}{t.backtrack();const s=b(...t.readUpto(">"));t.next(),o=s&&s.jdom,s.selfClosing||"object"!=typeof o||null===o||(o.children=w(t))}}else if("string"==typeof s)h("&"===s?n(s+t.readUntil(";")[0][0]):s);else if(s instanceof Array&&i(s[0]))for(const t of s)f(),o=t;else i(s)?(f(),o=s):h(s);return f(),s},d={jdom:(t,...s)=>{try{const o=new g(t.map(t=>t.replace(/\s+/g," ")),s);return w(o)[0]}catch(o){console.error(`Error parsing template: ${h(t,s)}\n${"stack"in o?o.stack:o}`)}}};if("object"==typeof window)for(const t in d)window[t]=d[t];"object"==typeof t.exports&&(t.exports=d)}]);
!function(t){var n={};function e(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=t,e.c=n,e.d=function(t,n,s){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(s,o,function(n){return t[n]}.bind(null,o));return s},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){const{renderJDOM:s,Component:o,Styled:i,StyledComponent:r,List:c,ListOf:h,Record:f,Store:d,StoreOf:u,Router:m}=e(1),{jdom:g}=e(2);t.exports={renderJDOM:s,Component:o,Styled:i,StyledComponent:r,List:c,ListOf:h,Record:f,Store:d,StoreOf:u,Router:m,jdom:g}},function(t,n,e){const s=["type","value","selected","indeterminate","tabIndex","checked","disabled"];let o=0;const i=t=>"object"==typeof t&&null!==t,r=t=>{"tag"in t||(t.tag="div"),"attrs"in t||(t.attrs={}),"events"in t||(t.events={}),"children"in t||(t.children=[])},c=t=>t instanceof Array?t:[t],h=()=>document.createComment(""),f=new Map;const d=(t,n,e)=>{function u(n){if(void 0!==t&&t!==n&&t.parentNode){const e=h();f.set(e,n),t.parentNode.replaceChild(e,t)}t=n}if(o++,n!==e)if(e instanceof Node)u(e);else if(null===e)u(h());else if("string"==typeof e||"number"==typeof e)u(document.createTextNode(e));else if(i(e)){(!i(n)||n instanceof Node)&&(n={tag:null}),r(n),r(e),n.tag===e.tag&&t||(void 0===t||r(n={}),u(document.createElement(e.tag)));for(const o in e.attrs)switch(o){case"class":const i=c(n.attrs.class||[]),r=c(e.attrs.class);for(const n of r)t.classList.add(n);for(const n of i)r.includes(n)||t.classList.remove(n);break;case"style":const h=n.attrs.style||{},f=e.attrs.style;for(const n in f)f[n]!==h[n]&&(t.style[n]=f[n]);for(const n in h)n in e.attrs.style||(t.style[n]="");break;default:s.includes(o)?t[o]=e.attrs[o]:e.attrs[o]!==n.attrs[o]&&t.setAttribute(o,e.attrs[o])}for(const o in n.attrs)o in e.attrs||(s.includes(o)?t[o]=null:t.removeAttribute(o));const o=(t,n,e)=>{for(const s in t){const o=c(t[s]||[]),i=c(n[s]);for(const t of o)i.includes(t)||e(s,t)}};o(e.events,n.events,(n,e)=>{t.addEventListener(n,e)}),o(n.events,e.events,(n,e)=>{t.removeEventListener(n,e)});const m=t.childNodes,g=n.children,a=e.children;if(a.length+g.length>0)if(g.length<a.length){let n;for(n=0;n<g.length;n++)d(m[n],g[n],a[n]);for(;n<a.length;)t.appendChild(d(void 0,void 0,a[n])),n++}else{let n;for(n=0;n<a.length;n++)d(m[n],g[n],a[n]);for(;n<g.length;){const e=h();t.replaceChild(e,m[n]),f.set(e,null),n++}}}return 0===--o&&function(){for(const[t,n]of f.entries())null===n?t.parentNode.removeChild(t):t.parentNode.replaceChild(n,t);f.clear()}(),t},u=()=>({source:null,handler:()=>{}});class m{constructor(...t){this.jdom=void 0,this.node=void 0,this.event=u(),this.init(...t),this.render()}static from(t){return class extends m{init(...t){this.args=t}compose(){return t(...this.args)}}}init(){}get record(){return this.event.source}bind(t,n){if(this.unbind(),!(t instanceof y))throw new Error("Event source to bind() to is not an instance of Evented");this.event={source:t,handler:n},t.addHandler(n)}unbind(){this.record&&this.record.removeHandler(this.event.handler),this.event=u()}remove(){this.unbind()}compose(t){return null}preprocess(t,n){return t}render(t){t=t||this.record&&this.record.summarize();const n=this.preprocess(this.compose(t),t);return this.node=d(this.node,this.jdom,n),this.jdom=n,this.jdom}}const g=new Set;let a=null;const x=(t,n)=>t+"{"+n+"}",p=(t,n)=>{let e=[],s="";for(const[o,i]of Object.entries(n))if("@"===o[0])o.startsWith("@media")?e.push(x(o,p(t,i).join(""))):e.push(x(o,p("",i).join("")));else if("object"==typeof i)if(o.includes("&")){const n=o.replace(/&/g,t);e=e.concat(p(n,i))}else e=e.concat(p(t+" "+o,i));else s+=o+":"+i+";";return s&&e.push(x(t,s)),e},w=t=>{const n=(t=>{const n=JSON.stringify(t).replace(/\s+/g," ");let e=n.length,s=1989;for(;e;)s=13*s^n.charCodeAt(--e);return"_torus"+(s>>>0)})(t);if(!g.has(n)){a||(styleElement=document.createElement("style"),styleElement.setAttribute("data-torus",""),document.head.appendChild(styleElement),a=styleElement.sheet);const e=p("."+n,t);for(const t of e)a.insertRule(t,a.cssRules.length);g.add(n)}return n},_=t=>(class extends t{styles(t){return{}}preprocess(t,n){return i(t)&&(t.attrs=t.attrs||{},t.attrs.class=c(t.attrs.class||[]),t.attrs.class.push(w(this.styles(n)))),t}}),l=_(m);class b extends m{get itemClass(){return m}init(t){this.store=t,this.items=new Map,this.filterFn=null,this.bind(this.store,()=>this.itemsChanged()),this.itemsChanged()}itemsChanged(){const t=this.store.summarize();for(const n of this.items.keys())t.includes(n)||(this.items.get(n).remove(),this.items.delete(n));for(const n of t)this.items.has(n)||this.items.set(n,new this.itemClass(n));let n=[...this.items.entries()];null!==this.filterFn&&(n=n.filter(t=>this.filterFn(t[0]))),n.sort((n,e)=>t.indexOf(n[0])-t.indexOf(e[0])),this.items=new Map(n),this.render()}filter(t){this.filterFn=t,this.itemsChanged()}unfilter(){this.filterFn=null,this.itemsChanged()}get nodes(){return[...this.items.values()].map(t=>t.node)}remove(){super.remove();for(const t of this.items.values())t.remove()}compose(t){return{tag:"ul",children:this.nodes}}}class y{constructor(){this.eventTargets=new Set}summarize(){throw new Error(`#summarize() not implemented in ${this.constructor.name}`)}emitEvent(){const t=this.summarize();for(const n of this.eventTargets)n(t)}addHandler(t){this.eventTargets.add(t),t(this.summarize())}removeHandler(t){this.eventTargets.delete(t)}}class E extends y{constructor(t,n={}){super(),"object"!=typeof t||Object.keys(n).length||(n=t,t=null),this.id=t,this.data=n}update(t){Object.assign(this.data,t),this.emitEvent()}get(t){return this.data[t]}summarize(){return Object.assign({},this.data,{id:this.id})}serialize(){return this.summarize()}}class z extends y{constructor(t=[]){super(),this.reset(t)}get recordClass(){return E}get comparator(){return null}create(t,n){this.add(new this.recordClass(t,n))}add(t){this.records.add(t),this.emitEvent()}remove(t){this.records.delete(t),this.emitEvent()}reset(t){this.records=new Set(t),this.emitEvent()}summarize(){return[...this.records].map(t=>[this.comparator?this.comparator(t):null,t]).sort((t,n)=>t[0]<n[0]?-1:t[0]>n[0]?1:0).map(t=>t[1])}serialize(){return this.summarize().map(t=>t.serialize())}}const j=t=>{let n;const e=[];for(;null!==n;)if(n=/:\w+/.exec(t)){const s=n[0];e.push(s.substr(1)),t=t.replace(s,"(.*)")}return[new RegExp(t),e]};const M={renderJDOM:d,Component:m,Styled:_,StyledComponent:l,List:b,ListOf:t=>(class extends b{get itemClass(){return t}}),Record:E,Store:z,StoreOf:t=>(class extends z{get recordClass(){return t}}),Router:class extends y{constructor(t){super(),this.routes=Object.entries(t).map(([t,n])=>[t,...j(n)]),this.lastMatch=["",null],this._cb=(()=>this.route(location.pathname)),window.addEventListener("popstate",this._cb),this._cb()}summarize(){return this.lastMatch}go(t){history.pushState(null,document.title,t),this.route(t)}route(t){for(const[n,e,s]of this.routes){const o=e.exec(t);if(null!==o){const t={},e=o.slice(1);s.forEach((n,s)=>t[n]=e[s]),this.lastMatch=[n,t];break}}this.emitEvent()}remove(){window.removeEventListener("popstate",this._cb)}}};if("object"==typeof window)for(const t in M)window[t]=M[t];"object"==typeof t.exports&&(t.exports=M)},function(t,n,e){const s=t=>"object"==typeof t&&null!==t&&"tag"in t,o=t=>"string"==typeof t||"number"==typeof t,i=(t,n)=>t.substr(0,t.length-n.length),r=t=>String.fromCodePoint(+("0"+/&#(\w+);/.exec(t)[1])),c=(t,n)=>{let e=t[0];for(let s=1;s<=n.length;s++)e+=n[s-1]+t[s];return e},h=[];class f{constructor(t){this.idx=0,this.content=t}next(){let t=this.content[this.idx++]||h;return this.idx>this.content.length&&(this.idx=this.content.length),t}backtrack(){this.idx--,this.idx<0&&(this.idx=0)}readUpto(t){const n=this.content.substr(this.idx).indexOf(t);return this.readToNextIdx(n)}readUntil(t){const n=this.content.substr(this.idx).indexOf(t)+t.length;return this.readToNextIdx(n)}readToNextIdx(t){const n=this.content.substr(this.idx);if(-1===t)return this.idx=this.content.length,n;{const e=n.substr(0,t);return this.idx+=t,e}}clipEnd(t){return!!this.content.endsWith(t)&&(this.content=i(this.content,t),!0)}}const d=t=>{let n="";for(let e=0;e<t.length;e++)n+="-"===t[e]?t[++e].toUpperCase():t[e];return n},u=t=>{if("!"===t[0])return{jdom:null,selfClosing:!0};if(!t.includes(" ")){const n=t.endsWith("/");return{jdom:{tag:n?i(t,"/"):t,attrs:{},events:{}},selfClosing:n}}const n=new f(t.trim()),e=n.clipEnd("/");let s="";const o={},r={},c=(t,n)=>{if("string"==typeof n&&n.startsWith("jdom_placeholder_function_"))r[t.replace("on","")]=[n];else if("class"===t)(n=n.trim())&&(o[t]=n.split(" "));else if("style"===t){const e=n.split(";").filter(t=>!!t).map(t=>{const[n,...e]=t.split(":");return[d(n.trim()),e.join(":").trim()]}),s={};for(const[t,n]of e)s[t]=n;o[t]=s}else o[t]=n};let u="",m=!1,g=!1;const a=[];let x=0;const p=t=>{(""!==(u=u.trim())||t)&&(a.push({type:x,value:u}),m=!1,u="")};for(let t=n.next();t!==h;t=n.next())switch(t){case"=":g?u+=t:(p(),m=!0,x=1);break;case" ":g?u+=t:m||(p(),x=0);break;case"\\":g&&(t=n.next(),u+=t);break;case'"':g?(g=!1,p(!0),x=0):1===x&&(g=!0);break;default:u+=t,m=!1}p(),s=a.shift().value;let w=null,_=a.shift();const l=()=>{w=_,_=a.shift()};for(;void 0!==_;)1===_.type?(c(w.value,_.value),l()):w&&c(w.value,!0),l();return w&&0===w.type&&c(w.value,!0),{jdom:{tag:s,attrs:o,events:r},selfClosing:e}},m=t=>{const n=[];let e=null,s=!1;const o=()=>{s&&""===e.trim()&&(e=null),e&&n.push(e),e=null,s=!1},i=t=>{s||(o(),s=!0,e=""),e+=t};for(let n=t.next();n!==h;n=t.next())if("<"===n){if(o(),"/"===t.next()){t.readUntil(">");break}{t.backtrack();const n=u(t.readUpto(">"));t.next(),e=n&&n.jdom,n.selfClosing||"object"!=typeof e||null===e||(e.children=m(t))}}else i("&"===n?r(n+t.readUntil(";")):n);return o(),n},g=new Map,a=/jdom_placeholder_(?:function|object|node)_\[(\d+)\]/,x=t=>"string"==typeof t&&t.includes("jdom_placeholder_"),p=(t,n)=>{if(x(t)){const[e,s]=a.exec(t),[o,i]=t.split(e),r=p(i,n);let c=[];return o&&c.push(o),n[s]instanceof Array?c=c.concat(n[s]):c.push(n[s]),r.length&&(c=c.concat(r)),c}return t?[t]:[]},w=(t,n)=>{let e=[];for(const s of t)e=e.concat(p(s,n));const s=e[0],o=e[e.length-1];return"string"!=typeof s||s.trim()||e.shift(),"string"!=typeof o||o.trim()||e.pop(),e},_=(t,n)=>{if(x(t)){const[e,s]=a.exec(t);if(t.trim()===e)return n[s];{const[o,i]=t.split(e);return o+n[s]+_(i,n)}}return t},l=(t,n)=>{t.forEach((e,s)=>{o(e)?t[s]=_(e.toString(),n):e instanceof Array?l(e,n):"object"==typeof e&&null!==e&&b(e,n)})},b=(t,n)=>{for(const[e,s]of Object.entries(t))if(o(s))t[e]=_(s.toString(),n);else if(s instanceof Array)if("children"===e){t.children=w(s,n);for(const e of t.children)"object"==typeof s&&null!==s&&b(e,n)}else l(s,n);else"object"==typeof s&&null!==s&&b(s,n)},y={jdom:(t,...n)=>{const e=t.join("jdom_tpl_joiner");try{if(!g.has(e)){const s=n.map((t,n)=>t instanceof Function?`jdom_placeholder_function_[${n}]`:`jdom_placeholder_object_[${n}]`),o=new f(c(t.map(t=>t.replace(/\s+/g," ")),s)),i=m(o)[0];g.set(e,t=>{if("string"==typeof i)return _(i,t);if("object"==typeof i){const n={},e=JSON.parse(JSON.stringify(i));return b(Object.assign(n,e),t),n}return null})}return g.get(e)(n)}catch(e){return console.error(`Error parsing template: ${c(t,n)}\n${"stack"in e?e.stack:e}`),""}}};if("object"==typeof window)for(const t in y)window[t]=y[t];"object"==typeof t.exports&&(t.exports=y)}]);
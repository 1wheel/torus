<!DOCTYPE html>
<html>
  <head>
    <title>Torus Test</title>
  </head>
  <body>
    <script src='/torus.js'></script>
    <script>
      class Toggle extends Component {

        initialize() {
          this.state = false;
        }

        onToggle() {
          this.state = !this.state;
          this.render();
        }

        compose() {
          return (
            button({}, {
              click: this.onToggle.bind(this),
            }, [
              this.state ? ':D' : ':\'(',
            ])
          );
        }

      }

      class App extends Component {

        initialize() {
          this.clickTimes = 0;
          this.toggles = [];
        }

        buttonClick() {
          this.clickTimes ++;
          this.toggles.push(new Toggle());
          this.render();
        }

        compose() {
          return (
            div([
              h1([
                'Hello, ', em(['World!']),
              ]),
              p([
                'Button has been pressed ', this.clickTimes, ' times.',
              ]),
              button({
                style: {
                  background: 'blue',
                  color: '#fff',
                },
              }, {
                click: this.buttonClick.bind(this),
              }, [
                'Click me!',
              ]),
              ul([
                ...this.toggles.map(t => {
                  return li([t.node]);
                }),
              ]),
            ])
          );
        }
      }

      const app = new App();
      document.body.appendChild(app.node);
    </script>
  </body>
</html>
